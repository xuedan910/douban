!function(e,t,a){var c=a("body"),n=a(".search"),s=a(".search input"),o=1,i=a(".search_results_subjects"),r=(a("#template-tag").html(),a("#more-search"));a(".button-search").on("click",function(){c.addClass("is-scrolling-disabled"),n.removeClass("is-hidden"),s.focus()}),a(".button-cancel-search").on("click",function(){c.removeClass("is-scrolling-disabled"),n.addClass("is-hidden")});var l=function(e,t){r.hide(),a.ajax({url:"/j/search/",dataType:"json",data:{q:e,t:t,p:o},success:function(e){try{var t=e.limit*(o+1);e.html&&(i.append(e.html),o+=1,t<e.count&&r.show())}catch(e){i.html(a("#template-search-exception").html().replace("{{ message }}",e.message))}}})};s.on("blur",function(){var e=s.val();e.length&&a("#button-search").click()}),s.on("keydown",function(e){if(13===e.keyCode){var t=s.val();if(t.length)return a("#button-search").click(),!1}}),a(t).on("click","#more-search",function(){var e=a(this),t=e.data("keyword"),c=e.data("type");l(t,c)}),a(t).on("click","#button-search",function(){a("#search_form").submit()})}(window,document,Zepto);